syntax = "proto3";
option optimize_for = SPEED;

option go_package = "github.com/luyuancpp/protooption;messageoption";

import "descriptor.proto";

// ==============================================================================
// 节点类型定义（所有服务节点的类型标识）
// ==============================================================================
enum NodeType {
	// 基础类型
	NODE_UNSPECIFIED = 0;                      // 默认值（未指定）
	NODE_CLIENT = 1;                           // 客户端节点

	// 核心服务节点
	NODE_GATE = 2;                             // 网关服节点
	NODE_ROOM = 3;                             // 房间服节点
	NODE_CENTRE = 4;                           // 中心服节点
	NODE_DB = 5;                               // 数据库节点
	NODE_DEPLOY = 6;                           // 部署节点服务
	NODE_DB_SERVICE = 7;                       // 数据库节点服务

	// 游戏业务节点
	NODE_CENTRE_SCENE = 8;                     // 场景切换中心服务器服务
	NODE_SCENE = 9;                            // 场景服务器服务
	NODE_LOGIN = 10;                           // 登录服务器节点服务
	NODE_MAIL = 13;                            // 邮件节点服务
	NODE_CHAT = 14;                            // 聊天节点服务
	NODE_TEAM = 15;                            // 组队节点服务
	NODE_ACTIVITY = 16;                        // 活动节点服务
	NODE_TRADE = 17;                           // 玩家交易或拍卖行服务
	NODE_RANK = 18;                            // 排行榜服务
	NODE_TASK = 19;                            // 任务系统服务
	NODE_GUILD = 20;                           // 公会系统服务
	NODE_MATCH = 21;                           // 匹配系统服务（如组队副本、PVP等）
	NODE_AI = 22;                              // AI/NPC 控制服务

	// 基础设施节点
	NODE_REDIS = 11;                           // Redis 节点服务
	NODE_ETCD = 12;                            // etcd节点
	NODE_LOG = 23;                             // 日志处理/收集服务
	NODE_PAYMENT = 24;                         // 支付或充值服务
	NODE_SECURITY = 25;                        // 反作弊/安全验证服务
	NODE_CROSS_SERVER = 26;                    // 跨服服务处理（如跨服战场）
	NODE_ANALYTICS = 27;                       // 数据统计与分析服务
	NODE_GM = 28;                              // GM工具服务（客服/管理员指令）
	NODE_PLAYER_LOCATOR = 29;                  // 跨服玩家定位服务
}

// ==============================================================================
// Protobuf扩展选项定义
// ==============================================================================

// 文件级选项：标记整个文件的默认节点类型
extend google.protobuf.FileOptions {
	NodeType OptionFileDefaultNode = 200003;
}

// 服务级选项
extend google.protobuf.ServiceOptions {
	// 标记该服务是否是玩家相关服务（PlayerService）
	bool OptionIsPlayerService = 400000;
	// 标记该服务是否是客户端协议服务（供客户端调用）
	bool OptionIsClientProtocolService = 400001;
}

// 消息级选项（数据库相关）
extend google.protobuf.MessageOptions {
	optional uint32 OptionTableId			= 500000 ;	//表ID
	optional string OptionTableName			= 500001 ;	//表名
	optional string OptionPrimaryKey		= 500002 ;	//主键
	optional string OptionForeignKey		= 500003 ;	//外键
	optional string OptionForeignReferences	= 500005 ;	//外键的关联表
	optional string OptionAutoIncrementKey	= 500006 ;	//自增长的Key
	optional string	OptionBackupTableName	= 500007	;	//备份表的名称
	optional bool	OptionLoadOnly			= 500008	;	//只用于数据加载
	optional string	OptionProcedureName		= 500009	;	//存储过程名称
	optional string	OptionProcedureResult	= 500010	;	//存储过程返回结果的PB结构Name
	optional string	OptionIndex				= 500011	;	//建立索引
	optional string OptionUniqueKey			= 500012	;   //唯一键
	optional bool OptionIsPlayerDatabase = 500013;  // 标识是否是玩家数据库
	optional OPERATE_TYPE OptionOperateType = 500014;

	// ---------- 属性同步相关 ----------
	optional bool OptionBaseAttributeSync   = 700000;  // 基础属性同步
	optional bool OptionDeltaAttributeSync  = 700001;  // 增量属性同步
}

// 字段级选项（数据库相关）
extend google.protobuf.FieldOptions {
	optional uint32 OptionRepeatLimit	= 600000 ;	// repeat 字段限制的个数
	optional string OptionDBFieldExtra	= 600001 ;	// 创建数据库要用到得额外信息，如果没有该属性表示非数据库字段
	optional bool   OptionDBReadOnly	= 600002 ;	// 该字段对DB是否只读
	optional string	OptionDBNamePrefix	= 600003 ;	// 数据库名称前缀
	optional string	OptionDBLoadSql		= 600004 ;	// 数据加载SQL语句
	optional bool	OptionDBNeedEscape	= 600005 ;	// 字段是否需要转义存储
	optional bool	OptionDBProcParam	= 600006 ;	// 是否存储过程参数
	optional string OptionOldName		= 600007 ;   //用来自动修改字段名
	optional string OptionTable			= 600008 ;	// 建表名称
	optional string OptionBackUpTabel	= 600009 ;	//备份表
}

// ==============================================================================
// 通用枚举类型
// ==============================================================================

// 数据操作类型
enum OPERATE_TYPE {
	OPERATE_NONE   = 0;     //无操作
	OPERATE_INSERT = 1;     //插入数据
	OPERATE_UPDATE = 2;     //更新数据
	OPERATE_DELETE = 3;     //删除数据
	OPERATE_LOAD   = 4;     //加载数据
	OPERATE_DELETE_CACHE = 5;     //删除缓存
	OPERATE_REPLACE = 6;    //替换数据
	OPERATE_CALL_PROC = 7;	//调用存储过程
	OPERATE_DELETE_BACKUP =8;	//删除备份
}

// 业务操作结果类型
enum BS_RESULT_TYPE{
	BS_RESULT_NONE		= 0;     //无结果
	BS_RESULT_SUCCESS	= 1;     //操作成功
	BS_RESULT_FAILED	= 2;     //操作失败
};